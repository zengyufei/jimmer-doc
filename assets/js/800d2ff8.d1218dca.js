"use strict";(self.webpackChunkdocusaurus_code=self.webpackChunkdocusaurus_code||[]).push([[5793],{27091:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"mapping/base/nullity","title":"Nullity","description":"Jimmer handles the issue of whether entity object properties can be null in a very strict way. Even for Java developers, it requires thinking about whether each property can be null in the same way as Kotlin developers.","source":"@site/docs/mapping/base/nullity.mdx","sourceDirName":"mapping/base","slug":"/mapping/base/nullity","permalink":"/jimmer-doc/docs/mapping/base/nullity","draft":false,"unlisted":false,"editUrl":"https://github.com/babyfish-ct/jimmer-doc/edit/main/docs/mapping/base/nullity.mdx","tags":[],"version":"current","lastUpdatedAt":1704015848000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Nullity"},"sidebar":"tutorialSidebar","previous":{"title":"Base mapping","permalink":"/jimmer-doc/docs/mapping/base/"},"next":{"title":"Simple Mapping","permalink":"/jimmer-doc/docs/mapping/base/basic"}}');var s=i(74848),l=i(28453);const o={sidebar_position:1,title:"Nullity"},r=void 0,a={},d=[{value:"Define nullity of properties",id:"define-nullity-of-properties",level:2},{value:"Kotlin",id:"kotlin",level:3},{value:"Java",id:"java",level:3},{value:"Precautions",id:"precautions",level:2},{value:"inputNotNull",id:"inputnotnull",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Jimmer handles the issue of whether entity object properties can be null in a very strict way. Even for Java developers, it requires thinking about whether each property can be null in the same way as Kotlin developers."}),"\n",(0,s.jsx)(n.admonition,{type:"caution",children:(0,s.jsx)(n.p,{children:"Explicitly stating whether each property of the entity object allows null is very important for Jimmer and affects many features."})}),"\n",(0,s.jsx)(n.h2,{id:"define-nullity-of-properties",children:"Define nullity of properties"}),"\n",(0,s.jsx)(n.h3,{id:"kotlin",children:"Kotlin"}),"\n",(0,s.jsxs)(n.p,{children:["Kotlin supports null safety. Declaring entity properties as ",(0,s.jsx)(n.code,{children:"T"})," for non-null and ",(0,s.jsx)(n.code,{children:"T?"})," for nullable according to Kotlin's own way."]}),"\n",(0,s.jsx)(n.h3,{id:"java",children:"Java"}),"\n",(0,s.jsx)(n.p,{children:"Whether a property is null in Java is determined by the following rules:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"If the property type is boolean, char, byte, short, int, long, float or double, then it is non-null."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"If the property type is Boolean, Character, Byte, Short, Integer, Long, Float or Double, then it is nullable."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Otherwise"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["If the property is decorated by any annotation simply named ",(0,s.jsx)(n.code,{children:"Nullable"})," or ",(0,s.jsx)(n.code,{children:"Null"}),", then it is nullable."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Otherwise, the default is non-null."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.admonition,{type:"note",children:[(0,s.jsxs)(n.p,{children:["It is recommended to use ",(0,s.jsx)(n.code,{children:"org.jetbrains.annotations.Nullable"}),", because"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Although recognizable annotations are not restricted, if an annotation not included by default in the Jimmer annotation processor is used, its dependency needs to be added to the annotation processor, which is troublesome after all."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"org.jetbrains.annotations.Nullable"})," is supported by Intellij."]}),"\n"]}),"\n"]})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"precautions",children:"Precautions"}),"\n",(0,s.jsxs)(n.admonition,{type:"info",children:[(0,s.jsx)(n.p,{children:"A series of concepts not explained yet will appear here. They will all be explained in subsequent documents."}),(0,s.jsx)(n.p,{children:"Here is just a simple list of precautions. Please ignore these terms for now. This document does not provide related examples either. Come back and check after you understand all subsequent concepts."})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"@Id"})," property must be non-null."]}),"\n",(0,s.jsx)(n.p,{children:"Very different from JPA/Hibernate."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["JPA/Hibernate recommends declaring the id property as a nullable type, e.g. ",(0,s.jsx)(n.code,{children:"Long"})," instead of ",(0,s.jsx)(n.code,{children:"long"})," in Java, so that the absence of id and the need for automatic allocation can be expressed when saving data."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Jimmer must declare the id property as a non-null type, e.g. ",(0,s.jsx)(n.code,{children:"long"})," instead of ",(0,s.jsx)(n.code,{children:"Long"})," in Java. Jimmer relies on the dynamism of the entity objects themselves to express the absence of the id property."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"One-to-many and many-to-many properties must be non-null."}),"\n",(0,s.jsx)(n.p,{children:"One-to-many and many-to-many properties are represented by collections of length 0 instead of null when there is no data."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"One-to-one and many-to-one properties must be nullable when any of the following conditions is met:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Mapping based on join table, rather than foreign key"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Mapping based on pseudo foreign key, rather than real foreign key"}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:'A "pseudo foreign key" refers to a foreign key in the developer\'s mind, but there is no corresponding foreign key constraint in the database.'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Remote association"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"As the mirror side of @OneToOne association"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["If the associated entity has ",(0,s.jsx)(n.a,{href:"../../query/global-filter",children:"global filters"})," applied, then for one-to-one/many-to-one associations must be nullable even if they are directly based on foreign keys, unless all of the following conditions are met:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["All global filters applied to the associated entity implement the ",(0,s.jsx)(n.code,{children:"AssociationIntegrityAssuranceFilter"}),"/",(0,s.jsx)(n.code,{children:"KAssociationIntegrityAssuranceFilter"})," interface."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"All global filters applied to the associated entity are also applied to the current entity."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"inputnotnull",children:"inputNotNull"}),"\n",(0,s.jsx)(n.p,{children:"As mentioned before, due to some query scenarios, one-to-one and many-to-one properties based on foreign keys must be declared as nullable."}),"\n",(0,s.jsxs)(n.p,{children:["However, when saving data, developers may not expect users to modify the foreign key fields in the database to null. In this case, ",(0,s.jsx)(n.code,{children:"inputNotNull"})," of ",(0,s.jsx)(n.code,{children:"@OneToOne"})," or ",(0,s.jsx)(n.code,{children:"@ManyToOne"})," can be set to true, for example:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"@OneToOne(inputNotNull = true)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"@ManyToOne(inputNotNull = true)"})}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["If ",(0,s.jsx)(n.code,{children:"inputNotNull"})," is configured for an associated property, it will be given priority consideration in ",(0,s.jsx)(n.a,{href:"../../configuration/database-validation",children:"database validation"})," to verify that the foreign key field in the database cannot be null."]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>r});var t=i(96540);const s={},l=t.createContext(s);function o(e){const n=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);